<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve" xmlns:t="http://odoo.com/owl">

<t t-name="gas_station_cash.LiveCashInScreen" owl="1">
    <div class="live-cash-in-container">
        <div class="live-cash-in-card">

            <!-- STEP: counting + isOpening = Opening state -->
            <t t-if="state.step === 'counting' and state.isOpening">
                <div class="live-cash-in-icon opening">
                    <i class="fa fa-cog fa-spin"></i>
                </div>
                <h2 class="live-cash-in-title opening-title">Opening Machine...</h2>
                <p class="live-cash-in-subtitle opening-subtitle">Please wait a moment</p>
                <div class="live-cash-in-opening-warning">
                    <div class="opening-warning-icon"><i class="fa fa-hand-stop-o"></i></div>
                    <div class="opening-warning-text">
                        <p class="warning-en"><strong>DO NOT INSERT CASH YET</strong></p>
                        <p class="warning-th">Please wait until the screen changes</p>
                    </div>
                </div>
                <div class="live-cash-in-progress">
                    <div class="progress">
                        <div class="progress-bar progress-bar-striped progress-bar-animated"
                             role="progressbar" style="width: 100%"></div>
                    </div>
                    <p class="progress-text">Connecting to Glory machine...</p>
                </div>
                <div class="live-cash-in-actions">
                    <button class="live-cash-in-btn live-cash-in-btn-confirm" disabled="disabled">
                        <i class="fa fa-spinner fa-spin me-2"></i>Please Wait
                    </button>
                    <button class="live-cash-in-btn live-cash-in-btn-cancel" disabled="disabled">Cancel</button>
                </div>
            </t>

            <!-- STEP: counting + ready = Insert / Counting state -->
            <t t-elif="state.step === 'counting'">
                <div class="live-cash-in-deposit-icon">
                    <img t-att-src="depositIconUrl" t-att-alt="depositTypeName"/>
                </div>
                <p class="live-cash-in-deposit-type"><t t-esc="depositTypeName"/></p>

                <h2 class="live-cash-in-title">
                    <t t-if="state.isCounting">Counting...</t>
                    <t t-elif="state.liveAmount === 0">Insert Cash</t>
                    <t t-else="">Cash Received</t>
                </h2>
                <p class="live-cash-in-subtitle">
                    <t t-if="state.isCounting">กำลังนับเงิน กรุณารอสักครู่</t>
                    <t t-elif="state.liveAmount === 0">ใส่ธนบัตร/เหรียญได้เลย</t>
                    <t t-else="">รับเงินแล้ว กด OK เพื่อยืนยัน</t>
                </p>

                <div class="live-cash-in-machine-img">
                    <img src="/gas_station_cash/static/img/cash_in.png" alt="Insert cash here"/>
                </div>

                <div t-attf-class="live-cash-in-amount {{ state.liveAmount > 0 ? 'has-value' : '' }}">
                    <span class="live-cash-in-currency">฿</span>
                    <span class="live-cash-in-value"><t t-esc="state.liveAmount.toLocaleString()"/></span>
                </div>

                <div t-attf-class="live-cash-in-status {{ state.isCounting ? 'counting' : (state.liveAmount > 0 ? 'ready' : 'waiting') }}">
                    <t t-if="state.isCounting">
                        <i class="fa fa-circle-o-notch fa-spin"></i>
                        <span>Counting... / กำลังนับ...</span>
                    </t>
                    <t t-elif="state.liveAmount > 0">
                        <i class="fa fa-check-circle"></i>
                        <span>Ready / พร้อม</span>
                    </t>
                    <t t-else="">
                        <i class="fa fa-hand-paper-o"></i>
                        <span>Waiting for cash / รอรับเงิน</span>
                    </t>
                </div>

                <div class="live-cash-in-actions">
                    <button class="live-cash-in-btn live-cash-in-btn-confirm"
                            t-att-disabled="confirmDisabled"
                            t-on-click="_confirm">
                        <t t-if="state.isCounting">
                            <i class="fa fa-spinner fa-spin me-2"></i>Please Wait
                        </t>
                        <t t-elif="state.liveAmount === 0">
                            <i class="fa fa-check me-2"></i>OK
                        </t>
                        <t t-else="">
                            <i class="fa fa-check me-2"></i>OK (฿<t t-esc="state.liveAmount.toLocaleString()"/>)
                        </t>
                    </button>
                    <button class="live-cash-in-btn live-cash-in-btn-cancel"
                            t-att-disabled="cancelDisabled"
                            t-on-click="_cancel">
                        Cancel
                    </button>
                </div>

                <div class="live-cash-in-warning" t-if="state.isCounting">
                    <i class="fa fa-exclamation-triangle"></i>
                    <span>Do not remove cash while counting</span>
                </div>
            </t>

            <!-- STEP: pickup — after cancel, wait for user to collect cash -->
            <t t-elif="state.step === 'pickup'">
                <div class="withdrawal-card">
                    <div class="withdrawal-header">
                        <div class="withdrawal-icon pickup" style="background: linear-gradient(135deg, #f39c12, #e67e22);">
                            <i class="fa fa-hand-grab-o"></i>
                        </div>
                        <h2 class="withdrawal-title">Collect Your Cash</h2>
                        <p class="withdrawal-subtitle">กรุณาหยิบเงินออกจากเครื่อง</p>
                    </div>

                    <div class="withdrawal-pickup-image" style="text-align: center; margin: 16px 0;">
                        <img src="/gas_station_cash/static/img/withdrawal.png"
                             alt="Collect cash"
                             style="max-width: 100%; max-height: 200px; border-radius: 12px;"/>
                    </div>

                    <div class="withdrawal-dispensing-amount">
                        <span class="dispensing-currency">฿</span>
                        <span class="dispensing-value"><t t-esc="state.cancelAmount.toLocaleString()"/></span>
                    </div>

                    <div class="withdrawal-pickup-notice" style="text-align: center; padding: 24px; background: #fff3cd; border-radius: 12px; margin: 16px 0;">
                        <i class="fa fa-arrow-down fa-2x" style="color: #f39c12; margin-bottom: 12px; display: block;"></i>
                        <p style="font-size: 1.1rem; margin: 8px 0;">Please collect all cash from the dispenser</p>
                        <p style="color: #666;">กรุณาหยิบเงินทั้งหมดออกจากช่องจ่ายเงิน</p>
                    </div>

                    <div class="withdrawal-waiting" style="text-align: center; color: #888; margin-top: 16px;">
                        <i class="fa fa-spinner fa-spin"></i>
                        <span style="margin-left: 8px;">Waiting for cash to be collected...</span>
                    </div>
                </div>
            </t>

        </div>
    </div>
</t>

</templates>