<t t-name="gas_station_cash.ExchangeCashScreen" owl="1">
  <div class="o_exchange_cash_screen container text-center p-4">
    <h2 class="mb-4">Exchange Cash</h2>

    <!-- Alerts -->
    <t t-if="state.message">
      <div class="alert alert-{{ state.message.type }} text-center" role="alert">
        <t t-esc="state.message.text"/>
      </div>
    </t>

    <!-- Step 1: Counting (live cash-in) -->
    <t t-if="state.step == 'counting'">
      <div class="card shadow-sm p-4 text-center">
        <h4 class="mb-2">Insert notes/coins now</h4>
        <div class="display-5 my-3" style="color: #08c202ff">฿<t t-esc="state.liveAmount"/></div>
        <div class="text-muted">Live total counted</div>

        <div class="d-flex justify-content-center gap-3 mt-4">
          <button class="btn btn-success btn-lg px-4"
                  t-att-disabled="state.busy"
                  t-on-click="_confirmCounting">OK</button>
          <button class="btn btn-outline-secondary btn-lg px-4"
                  t-att-disabled="state.busy"
                  t-on-click="_cancelCounting">Cancel</button>
        </div>
      </div>
    </t>

    <!-- Step 2: Denomination selection -->
    <t t-if="state.step == 'denominations'">
      <h3 class="mb-2">Distribute: ฿<t t-esc="state.amount"/></h3>
      <!--<h5 class="text-muted" >Amount left: ฿<t t-esc="amountLeft"/></h5>-->
      <!--<h5 class="text-muted" style="color: #d61a0dff">Remaining: ฿<t t-esc="amountLeft"/></h5>-->
      <h5 class="mt-4" style="color: #d61a0dff">Remaining: ฿<t t-esc="amountLeft"/></h5>
      <h4 class="mt-4" style="color: #0348c9ff">Total Entered: ฿<t t-esc="totalSelected"/></h4>

      <div class="row row-cols-2 row-cols-md-3 g-3 mt-3">
        <t t-foreach="state.denominations" t-as="denom" t-key="denom.value">
          <div class="col">
            <div t-attf-class="card shadow-sm p-3 #{denom.qty > 0 ? 'border-success bg-light' : ''} #{canAdd(denom) ? '' : 'opacity-50'}">
              <h4 class="fw-bold mb-2">฿<t t-esc="denom.value"/></h4>
              <div class="d-flex align-items-center justify-content-center">
                <button class="btn btn-lg btn-outline-danger me-3"
                        t-att-disabled="denom.qty === 0"
                        t-on-click="() => decrement(denom)">–</button>
                <span class="fs-3 fw-bold"><t t-esc="denom.qty"/></span>
                <button class="btn btn-lg btn-outline-success ms-3"
                        t-att-disabled="!canAdd(denom)"
                        t-on-click="() => increment(denom)">+</button>
              </div>
            </div>
          </div>
        </t>
      </div>

      <div class="mt-3">
        <button class="btn btn-lg btn-success me-2"
                t-att-disabled="amountLeft !== 0"
                t-on-click="onConfirmDenominations">Proceed</button>
        <!--<button class="btn btn-lg btn-secondary" t-on-click="onHome">Cancel</button>-->
      </div>
    </t>

    <!-- Step 3: Summary -->
    <t t-if="state.step == 'summary'">
      <div class="mt-5 p-4 border rounded bg-white">
        <h3 class="mb-3">Summary</h3>
        <ul class="list-group mb-3">
          <t t-foreach="state.denominations" t-as="denom" t-key="denom.value">
            <t t-if="denom.qty > 0">
              <li class="list-group-item d-flex justify-content-between align-items-center">
                ฿<t t-esc="denom.value"/>
                <span class="badge bg-primary rounded-pill"><t t-esc="denom.qty"/></span>
              </li>
            </t>
          </t>
        </ul>
        <h4 class="mb-4">Total: ฿<t t-esc="totalSelected"/></h4>
        <button class="btn btn-lg btn-outline-primary" t-on-click="onHome">Done</button>
      </div>
    </t>
  </div>
</t>
